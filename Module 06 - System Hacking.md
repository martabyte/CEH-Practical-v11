# Module 06 - System Hacking #

## Dumping and Cracking SAM Hashes to Extract Plaintext Passwords ##
1. ``` cmd ``` > Run as Administrator
2. ``` wmic useraccount get name,sid ```
   * Administrator -> XXX-500
   * Guest -> XXX-501
  
### pwdump7 ###

``` PwDump7.exe > hashes.txt ``` - To dump the result into a file

Then, if any user account names are missing, complete them looking at the result of the '*wmic*' command.
 
### ophcrack ###

1. Load > From a PWDUMP file > Select the 'hashes.txt' file
2. Tables > Select the table 'Vista free' > Set the table directory to '_ophcrack\tables_vista_free\_'
3. Crack

- - - -

## Creating and Using Rainbow Tables ##

### Winrtgen ###
1. Add Table
   * Hash -> 'ntlm'
   * Min Len -> 4
   * Max Len -> 6
   * Chain Count -> 4000000
   * Charset -> 'loweralpha' (Depends on the password)
2. 'Ok' -> It will generate the Rainbow Table

### Rainbow Crack ###
1. File > Load NTLM Hashes from PWDUMP File... > Select the 'hashes.txt' file
2. Rainbow Table > Search Rainbow Table... > Select the generated Rainbow Table


- - - -

## Auditing System Passwords ##

### L0phtCrack ###
1. Target System Type: Windows(/Unix-Like)
2. Windows Import: Remote Machine (Local Machine, File Generated by PwDump)
3. Windows Import from Remote Machine (SMB): Host - Use Specific User Credentials
4. Choose Audit Type: Strong Password Audit (Quick PA, Common PA, Thorough PA)













