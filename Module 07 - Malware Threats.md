# Module 07 - Malware Threats #

## Creating and Remotely Controlling an HTTP Trojan ##

### HTTP RAT ###

In one machine (the attacker): ``` httprat.exe ``` > Set the port to the desired one
In another machine (the victim): ``` httpserver.exe ``` - It will run on the background


- - - - 

## Creating a Trojan Server ##

### GUI Trojan MoSucker ###

``` CreateServer.exe ``` > Default settings and save it as _'server.exe'_ and remember the port that was set
``` MoSucker.exe ``` > Type the IP of the victim and the port that was set in the previous step

In the victim machine, open ``` server.exe ```, and then on the attacker machine, in MoSucker click on 'Connect'.


- - - -

## Gaining Control ##

### njRAT ###

``` njRAT v0.7d.exe ``` > Select port and start
  * Builder > Host:<Victim IP>, and select 'Copy to StartUp' and 'Registry StartUp' > 'Build' - Creates a 'Server.exe' file
  
In the victim machine: Copy the 'Server.exe' file to the Desktop and open it.


- - - -

## Obfuscating a Trojan ##

### SwayzCryptor ###
``` swayzcryptor.exe ``` 
  * File -> The njRat 'Server.exe' created file
  * Select: Start Up, Mutex and Disable UAC
  * Encrypt (CryptedFile.exe)

In the victim machine: Copy the 'CryptedFile.exe' file to the Desktop and open it.

- - - -

## Creating a Server ##

### ProRat Tool ###

``` ProRat.exe ``` > 'Create ProRat Server (342 Kbayt)' > Default Settings but unselect all the ticks minus the ones in 'Invisibility' > Bind with File (Select an image)

In the victim machine: Run 'binded_server.exe'. It will turn into a .jpg.
In the attacker machine: Type the victim IP and port (default) and 'Connect'


- - - - 

## Creating a Trojan Server ##

### Theef ###

In the victim machine: ``` Server210.exe ```
In the attacker machine: ``` Client210.exe ``` > Type the victim IP and 'Connect'


- - - -

## Creating a Virus ##

### JPS Virus Maker Tool ###

``` jps.exe ``` > Select the desired options, 'Restart', 'Rundll32', Select the Server name (Ex. 'Svchost.exe') > 'Create Virus!' - Other options appear, such as 'Enable Convert to Worm' > Enable it and call it, for instance, 'fedevi'


- - - -

## Creating a Worm ##

### Internet Worm Maker Thing ###

``` ```
  1. Name the worm, author, version, output path...
  2. Select all the desired options
  3. 'Generate Worm' > ``` worm.vbs ```


- - - -

## Virus Analysis ##

### IDA Pro ###
Disassembler.

* View > Graphs > Flow Chart - The flow of the application
* HEX
* Structures

### OllyDbg ###

View:
  * Log Data
  * Executable Modules
  * Memory Map
  * CPU - Main Thread, Module Ntdll
  * Threads
  * Windows
  * Handles
  * SEH Chain
  * Call Stack
  * Breakpoints
  (...)

- - - -

## Detecting Trojans ##

### TCPView ###
Allows viewing processes and their PID, Protocol, Local Address, Local Port, Remote Address, Remote Port, State, Sent Packets, Sent Bytes... It allows to end the process and look at its properties.

### Autoruns for Windows ###
Allows viewing processes, dlls, services, logons, explorer applications, drivers, codecs... that **(run on startup????)**

### jv16 PowerTools ###

Main Tools:
  * Clean and Speedup My Computer
  * Uninstall Software and Leftovers
  * Control Which Programs Start Automatically
  * Speed Up My Computer's Startup
  * Immunize My Computer
  * Pictures AntiSpy
  * Windows AntiSpy
  * Check for Vulnerable Software
  * Startup Timer


- - - - 

## Monitoring TCP/IP Connections ##

### CurrPorts ###
Allows viewing processes and their Name, PID, Protocol, Local Address, Local Port, Remote Address, Remote Port... It allows to kill the process and look at its properties.


- - - -

## Removing Malware ##

### Clamwin ###

* Memory Scan
* Scan a Drive - Select the drive and click 'Scan'


- - - -

## Performing Registry Entry Monitoring ##

### Regshot ###
Compares two system state shots.

 
- - - -
 
## Startup Program Monitoring Tool ##

### WinPatrol ###

* Startup Programs
* Active Tasks
* IE Helpers - Browser plugins
* Services
* File Types
* Hidden Files
* Cookies
* File Size Monitor
(...)
 
